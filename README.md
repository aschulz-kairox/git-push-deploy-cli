# git-push-deploy-cli (gpd)

> **Git Push Deploy** - Deploy Node.js applications with a single `git push`. Zero-downtime, multi-server, with Slack/Discord notifications.

[![npm version](https://badge.fury.io/js/git-push-deploy-cli.svg)](https://www.npmjs.com/package/git-push-deploy-cli)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

## ğŸ¯ What is GPD?

GPD is a deployment tool that uses Git's push mechanism to deploy your applications. Push your code, and the server automatically installs dependencies and restarts your app - with zero downtime.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           GPD DEPLOYMENT FLOW                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   Developer Machine                          Production Server              â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                          â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      git push SSH         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚   â”‚  gpd deploy â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚   Bare Git Repo â”‚            â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚         â”‚                                            â”‚                      â”‚
â”‚         â”‚ 1. Build                                   â”‚ 2. post-receive      â”‚
â”‚         â”‚ 2. Stage artifacts                         â”‚    hook triggers     â”‚
â”‚         â”‚ 3. Commit                                  â–¼                      â”‚
â”‚         â”‚ 4. Push                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚         â”‚                                   â”‚  gpd install    â”‚            â”‚
â”‚         â”‚                                   â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚            â”‚
â”‚         â”‚                                   â”‚  â€¢ git checkout â”‚            â”‚
â”‚         â”‚                                   â”‚  â€¢ npm install  â”‚            â”‚
â”‚         â”‚                                   â”‚  â€¢ pm2 reload   â”‚            â”‚
â”‚         â”‚                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚         â”‚                                            â”‚                      â”‚
â”‚         â”‚ 5. Send notification                       â”‚ 3. App restarted    â”‚
â”‚         â”‚    to Slack/Discord                        â–¼                      â”‚
â”‚         â”‚                                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚         â–¼                                   â”‚  App Running    â”‚            â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”‚  (zero-downtime)â”‚            â”‚
â”‚   â”‚ ğŸ“± Slack/   â”‚                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚   â”‚   Discord   â”‚                                                          â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                          â”‚
â”‚         â”‚                                                                   â”‚
â”‚         â””â”€â”€ Developer receives: "âœ… my-api deployed successfully"          â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ—ï¸ Architecture Overview

### GPD: One Tool, Two Roles (Janus Architecture)

GPD is installed **both locally and on the server**. The same CLI serves different purposes depending on where it runs:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     GPD JANUS ARCHITECTURE                                   â”‚
â”‚                  (Same CLI, Two Roles)                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚      LOCAL (Dev Machine)        â”‚ â”‚      SERVER (Production)        â”‚  â”‚
â”‚   â”‚      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•       â”‚ â”‚      â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•       â”‚  â”‚
â”‚   â”‚                                 â”‚ â”‚                                 â”‚  â”‚
â”‚   â”‚   $ gpd deploy                  â”‚ â”‚   $ gpd install                 â”‚  â”‚
â”‚   â”‚   $ gpd init                    â”‚ â”‚     (called by git hook)        â”‚  â”‚
â”‚   â”‚   $ gpd stage                   â”‚ â”‚                                 â”‚  â”‚
â”‚   â”‚   $ gpd release                 â”‚ â”‚                                 â”‚  â”‚
â”‚   â”‚   $ gpd rollback                â”‚ â”‚                                 â”‚  â”‚
â”‚   â”‚   $ gpd config                  â”‚ â”‚                                 â”‚  â”‚
â”‚   â”‚   $ gpd logs (via SSH)          â”‚ â”‚                                 â”‚  â”‚
â”‚   â”‚   $ gpd daemon (via SSH)        â”‚ â”‚                                 â”‚  â”‚
â”‚   â”‚                                 â”‚ â”‚                                 â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                  â”‚                                   â–²                      â”‚
â”‚                  â”‚                                   â”‚                      â”‚
â”‚                  â”‚ 1. git push                       â”‚ 2. post-receive      â”‚
â”‚                  â”‚    (artifacts)                    â”‚    hook calls        â”‚
â”‚                  â”‚                                   â”‚    gpd install       â”‚
â”‚                  â–¼                                   â”‚                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                                                                     â”‚  â”‚
â”‚   â”‚   #!/bin/bash                                                       â”‚  â”‚
â”‚   â”‚   # post-receive hook (generated by gpd init)                       â”‚  â”‚
â”‚   â”‚                                                                     â”‚  â”‚
â”‚   â”‚   gpd install my-service -c /opt/app/.git-deploy.json              â”‚  â”‚
â”‚   â”‚   â–²                                                                 â”‚  â”‚
â”‚   â”‚   â”‚                                                                 â”‚  â”‚
â”‚   â”‚   â””â”€â”€ GPD calls ITSELF on the server!                               â”‚  â”‚
â”‚   â”‚                                                                     â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                             â”‚
â”‚   Installation:                                                             â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                             â”‚
â”‚                                                                             â”‚
â”‚   # On dev machine                      # On server                         â”‚
â”‚   npm install -g git-push-deploy-cli    npm install -g git-push-deploy-cli â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Deployment Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         WORKSPACE STRUCTURE                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   Your Workspace (local)                                                    â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                                    â”‚
â”‚   workspace/                                                                â”‚
â”‚   â”œâ”€â”€ .git-deploy.json          â—„â”€â”€ GPD configuration                      â”‚
â”‚   â”‚                                                                         â”‚
â”‚   â””â”€â”€ my-api/                       (your project)                          â”‚
â”‚       â”œâ”€â”€ src/                      source code                             â”‚
â”‚       â”œâ”€â”€ dist/                     build output                            â”‚
â”‚       â”œâ”€â”€ package.json                                                      â”‚
â”‚       â”‚                                                                     â”‚
â”‚       â””â”€â”€ deploy/                   â—„â”€â”€ GPD creates this                    â”‚
â”‚           â”œâ”€â”€ staging/              deploy repo for staging                 â”‚
â”‚           â”‚   â”œâ”€â”€ .git â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚           â”‚   â”œâ”€â”€ dist/                    â”‚ points to                      â”‚
â”‚           â”‚   â””â”€â”€ package.json             â”‚ bare repo                      â”‚
â”‚           â”‚                                â”‚                                â”‚
â”‚           â””â”€â”€ production/                  â”‚                                â”‚
â”‚               â”œâ”€â”€ .git â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”                           â”‚
â”‚               â”œâ”€â”€ dist/                    â”‚   â”‚                            â”‚
â”‚               â””â”€â”€ package.json             â”‚   â”‚                            â”‚
â”‚                                            â”‚   â”‚                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                            â”‚   â”‚                            â”‚
â”‚   Server (remote via SSH)                  â”‚   â”‚                            â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                  â”‚   â”‚                            â”‚
â”‚                                            â–¼   â–¼                            â”‚
â”‚   /git/deploy/                        Bare Git Repositories                 â”‚
â”‚   â”œâ”€â”€ staging/my-api/                 (receive pushes)                      â”‚
â”‚   â”‚   â””â”€â”€ hooks/post-receive          triggers gpd install                  â”‚
â”‚   â”‚                                                                         â”‚
â”‚   â””â”€â”€ production/my-api/                                                    â”‚
â”‚       â””â”€â”€ hooks/post-receive                                                â”‚
â”‚                                                                             â”‚
â”‚   /opt/apps/                          Application Directories               â”‚
â”‚   â”œâ”€â”€ staging/my-api/                 (where code runs)                     â”‚
â”‚   â”‚   â”œâ”€â”€ dist/                                                             â”‚
â”‚   â”‚   â”œâ”€â”€ package.json                                                      â”‚
â”‚   â”‚   â”œâ”€â”€ node_modules/                                                     â”‚
â”‚   â”‚   â””â”€â”€ .env                        â—„â”€â”€ generated from config             â”‚
â”‚   â”‚                                                                         â”‚
â”‚   â””â”€â”€ production/my-api/                                                    â”‚
â”‚       â”œâ”€â”€ dist/                                                             â”‚
â”‚       â””â”€â”€ ...                                                               â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Runtime Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         RUNTIME / HOSTING                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   Server                                                                    â”‚
â”‚   â”€â”€â”€â”€â”€â”€                                                                    â”‚
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚                     Process Manager (PM2 or GPDD)                    â”‚  â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚   â”‚                                                                     â”‚  â”‚
â”‚   â”‚   PM2 Mode                          GPDD Mode (Zero-Downtime)       â”‚  â”‚
â”‚   â”‚   â”€â”€â”€â”€â”€â”€â”€â”€                          â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€       â”‚  â”‚
â”‚   â”‚                                                                     â”‚  â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚  â”‚
â”‚   â”‚   â”‚   PM2   â”‚                       â”‚    GPDD Master      â”‚        â”‚  â”‚
â”‚   â”‚   â”‚ Daemon  â”‚                       â”‚  (cluster manager)  â”‚        â”‚  â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚  â”‚
â”‚   â”‚        â”‚                                       â”‚                    â”‚  â”‚
â”‚   â”‚        â”‚ manages                               â”‚ manages            â”‚  â”‚
â”‚   â”‚        â–¼                                       â–¼                    â”‚  â”‚
â”‚   â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚  â”‚
â”‚   â”‚   â”‚  App    â”‚                       â”‚  Worker 1  Worker 2 â”‚        â”‚  â”‚
â”‚   â”‚   â”‚ Process â”‚                       â”‚  Worker 3  Worker 4 â”‚        â”‚  â”‚
â”‚   â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚  â”‚
â”‚   â”‚                                                                     â”‚  â”‚
â”‚   â”‚   restart on crash                  â€¢ Rolling restart               â”‚  â”‚
â”‚   â”‚   cluster mode                      â€¢ Zero-downtime reload          â”‚  â”‚
â”‚   â”‚   log management                    â€¢ Built-in clustering           â”‚  â”‚
â”‚   â”‚                                                                     â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                             â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚   â”‚  Port 3000      â”‚    â”‚  Port 3001      â”‚    â”‚  Port 3002      â”‚       â”‚
â”‚   â”‚  my-api-staging â”‚    â”‚  my-api-prod    â”‚    â”‚  other-service  â”‚       â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚            â”‚                      â”‚                      â”‚                 â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                   â”‚                                        â”‚
â”‚                                   â–¼                                        â”‚
â”‚                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚                          â”‚  Reverse Proxy  â”‚                               â”‚
â”‚                          â”‚  (nginx/caddy)  â”‚                               â”‚
â”‚                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                               â”‚
â”‚                                   â”‚                                        â”‚
â”‚                                   â–¼                                        â”‚
â”‚                              Internet                                       â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## âš¡ Quick Start

### Installation

```bash
npm install -g git-push-deploy-cli
```

### 1. Configure your service

Create `.git-deploy.json` in your workspace root:

```json
{
  "services": {
    "my-api-staging": {
      "sourceDir": "my-api",
      "deployRepo": "deploy/staging",
      "artifacts": ["dist", "package.json"],
      "processManager": "pm2",
      "processName": "my-api-staging",
      "environment": "staging",
      "server": {
        "host": "deploy@myserver.com",
        "targetDir": "/opt/apps/staging/my-api",
        "bareRepo": "/git/deploy/staging/my-api"
      }
    }
  }
}
```

### 2. Initialize server (once)

```bash
gpd init my-api-staging
```

### 3. Deploy

```bash
gpd deploy my-api-staging
```

That's it! Your app is now running on the server.

## ğŸ“– Commands

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              GPD COMMANDS                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Command        â”‚ Description                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ gpd status     â”‚ Show all configured services                              â”‚
â”‚ gpd config     â”‚ Interactive configuration wizard                          â”‚
â”‚ gpd init       â”‚ Initialize server (bare repo, target dir, hooks)          â”‚
â”‚ gpd deploy     â”‚ Full deployment (stage + release)                         â”‚
â”‚ gpd stage      â”‚ Copy build artifacts to deploy repo                       â”‚
â”‚ gpd release    â”‚ Commit and push to server                                 â”‚
â”‚ gpd rollback   â”‚ Rollback to previous version                              â”‚
â”‚ gpd logs       â”‚ Show application logs from server                         â”‚
â”‚ gpd daemon     â”‚ Manage GPDD process (start/stop/status/logs)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Options        â”‚                                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ -m, --message  â”‚ Custom commit message                                     â”‚
â”‚ -n, --lines    â”‚ Number of log lines (default: 50)                         â”‚
â”‚ -f, --follow   â”‚ Follow logs in real-time                                  â”‚
â”‚ --dry-run      â”‚ Preview changes without executing                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ Features

### Multi-Server Deployment

Deploy to multiple servers simultaneously:

```json
{
  "services": {
    "my-api-prod": {
      "servers": [
        { "name": "primary", "host": "prod1.example.com", "targetDir": "/opt/app" },
        { "name": "replica", "host": "prod2.example.com", "targetDir": "/opt/app" }
      ]
    }
  }
}
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      MULTI-SERVER DEPLOYMENT                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚                        gpd deploy my-api-prod                            â”‚
â”‚                               â”‚                                          â”‚
â”‚                               â”‚                                          â”‚
â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚              â”‚                â”‚                â”‚                        â”‚
â”‚              â–¼                â–¼                â–¼                        â”‚
â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚       â”‚ Server 1 â”‚     â”‚ Server 2 â”‚     â”‚ Server 3 â”‚                   â”‚
â”‚       â”‚ (primary)â”‚     â”‚ (replica)â”‚     â”‚ (replica)â”‚                   â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
â”‚              â”‚                â”‚                â”‚                        â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚                               â”‚                                          â”‚
â”‚                               â–¼                                          â”‚
â”‚                      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚
â”‚                      â”‚ Load Balancer  â”‚                                 â”‚
â”‚                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Deployment Hooks

Run custom scripts before/after deployment:

```json
{
  "hooks": {
    "preDeploy": ["npm run lint", "npm test"],
    "postDeploy": ["npx prisma migrate deploy"],
    "postDeployLocal": ["echo 'Deployed!'"]
  }
}
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         DEPLOYMENT HOOKS                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚   LOCAL (Developer Machine)              SERVER                          â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”€â”€â”€â”€â”€â”€                          â”‚
â”‚                                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                               â”‚
â”‚   â”‚ 1. preDeploy hooks  â”‚  â—„â”€â”€ npm run lint, npm test                   â”‚
â”‚   â”‚    (local)          â”‚                                                â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                               â”‚
â”‚              â”‚                                                           â”‚
â”‚              â–¼                                                           â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚   â”‚ 2. git push         â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ 3. post-receive     â”‚        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚    hook             â”‚        â”‚
â”‚                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                     â”‚                    â”‚
â”‚                                                     â–¼                    â”‚
â”‚                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚                                          â”‚ 4. gpd install      â”‚        â”‚
â”‚                                          â”‚    â€¢ git checkout   â”‚        â”‚
â”‚                                          â”‚    â€¢ npm install    â”‚        â”‚
â”‚                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                     â”‚                    â”‚
â”‚                                                     â–¼                    â”‚
â”‚                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚                                          â”‚ 5. postDeploy hooks â”‚        â”‚
â”‚                                          â”‚    (server)         â”‚        â”‚
â”‚                                          â”‚    e.g. prisma      â”‚        â”‚
â”‚                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                     â”‚                    â”‚
â”‚                                                     â–¼                    â”‚
â”‚                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚                                          â”‚ 6. Process restart  â”‚        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚    (PM2/GPDD)       â”‚        â”‚
â”‚   â”‚ 7. postDeployLocal  â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚   â”‚    hooks            â”‚   notification                                 â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                               â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Notifications (Slack, Discord, Webhook)

Get notified on every deployment:

```json
{
  "notifications": {
    "slack": {
      "webhookUrl": "https://hooks.slack.com/services/xxx",
      "channel": "#deployments"
    },
    "discord": {
      "webhookUrl": "https://discord.com/api/webhooks/xxx"
    },
    "webhook": {
      "url": "https://your-api.com/deploy-hook",
      "headers": { "Authorization": "Bearer xxx" }
    }
  }
}
```

### Process Managers

GPD supports multiple process managers:

| Manager | Description | Use Case |
|---------|-------------|----------|
| `pm2` | Industry standard, feature-rich | Production, logging, monitoring |
| `gpdd` | Built-in, zero-downtime | Simple apps, zero-config |
| `systemd` | Linux system service | Server integration |

### Zero-Downtime with GPDD

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    GPDD ZERO-DOWNTIME RELOAD                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚   Before Reload                After gpdd reload                         â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                         â”‚
â”‚                                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚   â”‚    Master    â”‚             â”‚    Master    â”‚                         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚          â”‚                            â”‚                                  â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚    â”‚           â”‚               â”‚             â”‚                          â”‚
â”‚    â–¼           â–¼               â–¼             â–¼                          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”                      â”‚
â”‚ â”‚ W1   â”‚   â”‚ W2   â”‚         â”‚ W1   â”‚     â”‚ W2   â”‚                      â”‚
â”‚ â”‚ OLD  â”‚   â”‚ OLD  â”‚         â”‚ NEW  â”‚     â”‚ NEW  â”‚                      â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                                                                          â”‚
â”‚                              Rolling restart:                            â”‚
â”‚                              1. Start new W1                             â”‚
â”‚                              2. Stop old W1 (after ready)                â”‚
â”‚                              3. Start new W2                             â”‚
â”‚                              4. Stop old W2                              â”‚
â”‚                                                                          â”‚
â”‚                              âœ“ No dropped connections                    â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“‹ Full Configuration Reference

```typescript
interface ServiceConfig {
  // Source & Deploy
  sourceDir: string;              // Project directory (e.g., "my-api")
  deployRepo: string;             // Deploy repo path (e.g., "deploy/staging")
  artifacts: string[];            // Files to deploy (e.g., ["dist", "package.json"])
  
  // Process Manager
  processManager?: 'pm2' | 'gpdd' | 'systemd';
  processName: string;            // Process name
  pm2Home?: string;               // PM2_HOME directory
  pm2User?: string;               // User for PM2 (sudo -u)
  gpddWorkers?: number;           // GPDD worker count (0 = auto)
  gpddEntryPoint?: string;        // Entry point (default: dist/index.js)
  
  // Environment
  environment?: 'production' | 'staging' | 'development';
  env?: Record<string, string | number | boolean>;
  
  // Server (single)
  server?: {
    host: string;                 // SSH host (user@hostname)
    sshOptions?: string;          // SSH options (e.g., "-p 22")
    targetDir: string;            // Where code runs
    bareRepo: string;             // Git bare repo path
    group?: string;               // Unix group
    name?: string;                // Display name
  };
  
  // Servers (multi)
  servers?: ServerConfig[];       // Multiple servers
  
  // Hooks
  hooks?: {
    preDeploy?: string[];         // Run locally before push
    postDeploy?: string[];        // Run on server after install
    postDeployLocal?: string[];   // Run locally after success
  };
  
  // Notifications
  notifications?: {
    slack?: { webhookUrl: string; channel?: string; };
    discord?: { webhookUrl: string; };
    webhook?: { url: string; headers?: Record<string, string>; };
  };
}
```

## ğŸ”’ Security

### Environment Variable Substitution

GPD supports `${VAR_NAME}` syntax for sensitive values. This prevents secrets from being committed to version control:

```json
{
  "services": {
    "my-api": {
      "env": {
        "DATABASE_URL": "${DATABASE_URL}",
        "API_KEY": "${API_KEY}"
      },
      "notifications": {
        "slack": {
          "webhookUrl": "${SLACK_WEBHOOK_URL}"
        }
      }
    }
  }
}
```

**Best Practices:**
1. **Copy the example:** Start with `.git-deploy.example.json` as template
2. **Gitignore config:** Add `.git-deploy.json` to `.gitignore`
3. **Use env vars:** All webhook URLs, tokens, and credentials should use `${VAR}` syntax
4. **Set env vars:** Export variables before running gpd commands

```bash
export SLACK_WEBHOOK_URL="https://hooks.slack.com/..."
export DATABASE_URL="postgresql://..."
gpd deploy my-service
```

### Secret Detection

GPD warns if it detects hardcoded values in sensitive fields:

```
âš  Security warning: Possible hardcoded secrets detected in config:
  notifications.slack.webhookUrl: Consider using ${ENV_VAR} instead
  File: /path/to/.git-deploy.json
  Tip: Use ${ENV_VAR} syntax for sensitive values
```

### Input Validation

GPD validates all config values to prevent command injection:
- Host names: alphanumeric, `.`, `@`, `-`, `:`
- User names: alphanumeric, `_`, `-`
- Process names: alphanumeric, `_`, `-`
- Paths: alphanumeric, `/`, `.`, `_`, `-`

### Hook Execution

Hooks run with full shell access - this is by design. GPD logs hook execution clearly:

```
âš  Running pre-deploy hooks (2 commands)...
    Working directory: /path/to/project
    â–¶ npm run build
    âœ“ Hook completed
    â–¶ npm run test
    âœ“ Hook completed
```

## ğŸ› ï¸ Server Prerequisites

- **Node.js** (18+ recommended)
- **Git**
- **SSH access** from dev machine
- **PM2** or **GPDD** (installed globally)
- **GPD CLI** (installed globally on server)

```bash
# On server
npm install -g pm2 git-push-deploy-cli
# Or for GPDD
npm install -g git-push-deploy-daemon git-push-deploy-cli
```

## ğŸ“š More Documentation

- [Git-Based Deployment Guide](../docs/git-based-deployment.md)
- [PM2 Process Management](../docs/pm2-process-management.md)
- [GPDD Daemon Documentation](../git-push-deploy-daemon/README.md)

## ğŸ“„ License

MIT
